!function($){$.fn.bValidator=function(e){return new bValidator(this,e)},bValidator=function(mainElement,overrideOptions){var options={singleError:!1,offset:{x:0,y:-3},position:{x:"left",y:"top"},template:'<div class="{errMsgClass}"><em/>{message}</div>',showCloseIcon:!0,showErrMsgSpeed:"normal",closeIconClass:"bvalidator_close_icon",errMsgClass:"bvalidator_errmsg",errorClass:"bvalidator_invalid",validClass:"",lang:"en",errorMessageAttr:"data-bvalidator-msg",validateActionsAttr:"data-bvalidator",paramsDelimiter:":",validatorsDelimiter:",",validateOn:null,errorValidateOn:"change",onBeforeValidate:null,onAfterValidate:null,onValidateFail:null,onValidateSuccess:null,errorMessages:{en:{default:"Please correct this value.",equalto:"Please enter the same value again.",differs:"Please enter a different value.",minlength:"The length must be at least {0} characters",maxlength:"The length must be at max {0} characters",rangelength:"The length must be between {0} and {1}",min:"Please enter a number greater than or equal to {0}.",max:"Please enter a number less than or equal to {0}.",between:"Please enter a number between {0} and {1}.",required:"This field is required.",alpha:"Please enter alphabetic characters only.",alphanum:"Please enter alphanumeric characters only.",digit:"Please enter only digits.",number:"Please enter a valid number.",email:"Please enter a valid email address.",image:"This field should only contain image types",url:"Please enter a valid URL.",ip4:"Please enter a valid IP address.",date:"Please enter a valid date in format {0}.",mindate:"Please enter a date greater than or equal to {0}.",mindatefield:"Please enter a date greater than or equal to field.",mindatefield2:"Please enter a date greater than to field",maxdate:"Please enter a date less than or equal to {0}.",maxdatefield:"Please enter a date less than or equal to field.",autocomplete:"Please correct value."}},regex:{alpha:/^[a-z ._-]+$/i,alphanum:/^[a-z0-9 ._-]+$/i,digit:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^([a-zA-Z0-9_\.\-\+%])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,image:/\.(jpg|jpeg|png|gif|bmp)$/i,url:/^(http|https|ftp)\:\/\/[a-z0-9\-\.]+\.[a-z]{2,3}(:[a-z0-9]*)?\/?([a-z0-9\-\._\?\,\'\/\\\+&amp;%\$#\=~])*$/i,autocomplete:/.*\(.*\)$/i}},instance=this;if(window.bValidatorOptions&&$.extend(!0,options,window.bValidatorOptions),overrideOptions&&$.extend(!0,options,overrideOptions),mainElement.data("bValidator"))return mainElement.data("bValidator");mainElement.data("bValidator",this),mainElement.is("form")&&(mainElement.bind("submit.bV",function(e){return!!instance.validate()||(e.stopImmediatePropagation(),!1)}),mainElement.bind("reset.bV",function(){instance.reset()}));var _getElementsForValidation=function(e){if(e.is(":input"))var t=e;else t=e.find(":input").not(":button, :image, :reset, :submit, :hidden, :disabled");return t},_bindValidateOn=function(e){e.bind(options.validateOn+".bV",{bValidatorInstance:instance},function(e){e.data.bValidatorInstance.validate(!1,$(this))})},_showErrMsg=function(e,t){_removeErrMsg(e),msg_container=$('<div class="bVErrMsgContainer"></div>').css("position","absolute"),e.data("errMsg.bV",msg_container),msg_container.insertAfter(e);var a="";for(i=0;i<=t.length-1;i++)a+="<div>"+t[i]+"</div>\n";options.showCloseIcon&&(a=('<div style="display:table"><div style="display:table-cell">{message}</div><div style="display:table-cell"><div class="'+options.closeIconClass+'" onclick="$(this).closest(\'.'+options.errMsgClass+"').css('visibility', 'hidden');\">x</div></div></div>").replace("{message}",a));var n=options.template.replace("{errMsgClass}",options.errMsgClass).replace("{message}",a),r=$(n);r.appendTo(msg_container);var s=_getErrMsgPosition(e,r);r.css({visibility:"visible",position:"absolute",top:s.top,left:s.left}).fadeIn(options.showErrMsgSpeed)},_removeErrMsg=function(e){var t=e.data("errMsg.bV");t&&t.remove()},_getErrMsgPosition=function(e,t){var a=e.data("errMsg.bV"),i=-(a.offset().top-e.offset().top+t.outerHeight()-options.offset.y),n=e.offset().left+e.outerWidth()-a.offset().left+options.offset.x,r=options.position.x,s=options.position.y;if("center"==s||"bottom"==s){var o=t.outerHeight()+e.outerHeight();"center"==s&&(i+=o/2),"bottom"==s&&(i+=o)}if("center"==r||"left"==r){var l=e.outerWidth();"center"==r&&(n-=l/2),"left"==r&&(n-=l)}return{top:i,left:n}},_callBack=function(e,t,a,i){if($.isFunction(options[e]))return options[e](t,a,i)},_getValue=function(e){var t={};return e.is("input:checkbox")?(e.attr("name")&&(t.selectedInGroup=$("input:checkbox[name="+e.attr("name")+"]:checked").length),t.value=e.is(":checked")):e.is("input:radio")?e.attr("name")?t.value=$("input:radio[name="+e.attr("name")+"]:checked").length:t.value=e.val():e.is("select")?(t.selectedInGroup=$("option:selected",e).length,t.value=e.val()):e.is(":input")&&(t.value=e.val()),t},validator={equalto:function(e,t){return e.value==$("#"+t).val()},differs:function(e,t){return e.value!=$("#"+t).val()},minlength:function(e,t){return e.value.length>=t},maxlength:function(e,t){return e.value.length<=t},rangelength:function(e,t,a){return e.value.length>=t&&e.value.length<=a},min:function(v,min){return v.selectedInGroup?v.selectedInGroup>=min:("string"==typeof min&&(min=eval(min)),!!this.number(v)&&parseFloat(v.value)>=parseFloat(min))},max:function(e,t){return e.selectedInGroup?e.selectedInGroup<=t:!!this.number(e)&&parseFloat(e.value)<=parseFloat(t)},between:function(e,t,a){if(!this.number(e))return!1;var i=parseFloat(e.value);return i>=parseFloat(t)&&i<=parseFloat(a)},required:function(e){return!(!e.value||!$.trim(e.value))},alpha:function(e){return this.regex(e,options.regex.alpha)},autocomplete:function(e,t){if(this.regex(e,options.regex.autocomplete))switch(t){case"city":if($.inArray(e.value,external_file_Cities)>=0||"undefined"!=typeof external_file_cities_duplicate&&$.inArray(e.value,external_file_cities_duplicate)>=0)return!0;break;case"country":if($.inArray(e.value,external_file_Countries)>=0)return!0;break;case"airport":if($.inArray(e.value,external_file_Airports)>=0)return!0;break;case"airportscity":var a=external_file_AirportsCities;if(a.forEach(function(e,t){a[t].substring(a[t].indexOf("(")+1,a[t].indexOf(")")+1).indexOf("-")<0?a[t]=a[t].substring(a[t].indexOf("|")+1,a[t].length):(a[t]=a[t].substring(a[t].indexOf("|")+1,a[t].length),a[t]=a[t].substring(0,a[t].indexOf("(")+1)+a[t].substring(a[t].indexOf("-")+1,a[t].length))}),$.inArray(e.value,a)>=0||$.inArray(e.value+"|E",a)>=0)return!0;break;case"airline":if($.inArray(e.value,external_file_Airlines)>=0)return!0;break;default:return!0}else if("expedia"==t&&external_file_expedia_cities.filter(function(t){return t.label==e.value}).length>=0)return!0;return!1},alphanum:function(e){return this.regex(e,options.regex.alphanum)},digit:function(e){return this.regex(e,options.regex.digit)},number:function(e){return this.regex(e,options.regex.number)},email:function(e){return this.regex(e,options.regex.email)},image:function(e){return this.regex(e,options.regex.image)},url:function(e){return this.regex(e,options.regex.url)},regex:function(e,t,a){return"string"==typeof t&&(t=new RegExp(t,a)),t.test(e.value)},ip4:function(e){return!(!/^(([01]?\d\d?|2[0-4]\d|25[0-5])\.){3}([01]?\d\d?|25[0-5]|2[0-4]\d)$/.test(e.value)||"0.0.0.0"==e.value||"255.255.255.255"==e.value)},date:function(e,t){if(10==e.value.length&&10==t.length){var a=t.match(/[^mdy]+/g);if(2==a.length&&1==a[0].length&&a[0]==a[1]){for(var i=e.value.split(a[0]),n=t.split(a[0]),r=0;r<3;r++)if("dd"==n[r])var s=i[r];else if("mm"==n[r])var o=i[r];else if("yyyy"==n[r])var l=i[r];var u=new Date(l,o-1,s);return u.getMonth()+1==o&&u.getDate()==s&&u.getFullYear()==l}}return!1},mindate:function(e,t,a){return""==e.value||""==t||""==a||GetFormatedDate(e.value,a)>=GetFormatedDate(t,a)},mindatefield:function(e,t,a){return""==e.value||""==$("#"+t).val()||""==a||GetFormatedDate(e.value,a)>=GetFormatedDate($("#"+t).val(),a)},mindatefield2:function(e,t,a){return""==e.value||""==$("#"+t).val()||""==a||GetFormatedDate(e.value,a)>GetFormatedDate($("#"+t).val(),a)},maxdate:function(e,t,a){return""==e.value||""==t||""==a||GetFormatedDate(e.value,a)<=GetFormatedDate(t,a)},maxdatefield:function(e,t,a){return""==e.value||""==$("#"+t).val()||""==a||GetFormatedDate(e.value,a)>=GetFormatedDate($("#"+t).val(),a)},extension:function(){var e=arguments[0],t="";if(!arguments[1])return!1;for(var a=1;a<arguments.length;a++)t+=arguments[a],a!=arguments.length-1&&(t+="|");return this.regex(e,"\\.("+t+")$","i")}};options.validateOn&&_bindValidateOn(_getElementsForValidation(mainElement)),this.validate=function(e,t){if(t)var a=t;else a=_getElementsForValidation(mainElement);var i=!0;return a.each(function(){var t=$.trim($(this).attr(options.validateActionsAttr));if(!t)return!0;var a=t.split(options.validatorsDelimiter),n=_getValue($(this)),r=[],s=$(this).attr(options.errorMessageAttr),o=0;for(f=0;f<=a.length-1;f++)if(a[f]=$.trim(a[f]),a[f]&&!1!==_callBack("onBeforeValidate",$(this),a[f])){var l=a[f].match(/^(.*?)\[(.*?)\]/);if(l&&3==l.length){var u=$.trim(l[1]);l=l[2].split(options.paramsDelimiter)}else{l=[];u=a[f]}if("function"==typeof validator[u]){l.unshift(n);var d=validator[u].apply(validator,l)}else if("function"==typeof window[u]){l.unshift(n.value);d=window[u].apply(validator,l)}if(!1!==_callBack("onAfterValidate",$(this),a[f],d))if(d){if(!1===_callBack("onValidateSuccess",$(this),a[f]))continue}else{if(e)r[r.length]="";else if(!o){var c=$(this).attr(options.errorMessageAttr+"-"+u);if(null!=c&&(s=c),s?o=1:s=options.errorMessages[options.lang]&&options.errorMessages[options.lang][u]?options.errorMessages[options.lang][u]:options.errorMessages.en[u]?options.errorMessages.en[u]:options.errorMessages[options.lang]&&options.errorMessages[options.lang].default?options.errorMessages[options.lang].default:options.errorMessages.en.default,s.indexOf("{"))for(var f=0;f<l.length-1;f++)s=s.replace(new RegExp("\\{"+f+"\\}","g"),l[f+1]);r.length&&"required"==u||(r[r.length]=s),s=null}if(i=!1,!1===_callBack("onValidateFail",$(this),a[f],r))continue}}if(!e)if(r.length){if(_showErrMsg($(this),r),$(this).is("input:checkbox,input:radio")||($(this).removeClass(options.validClass),options.errorClass&&$(this).addClass(options.errorClass)),options.errorValidateOn){options.validateOn&&$(this).unbind(options.validateOn+".bV");var p=options.errorValidateOn;$(this).hasClass("ui-autocomplete-input")?p="blur":$(this).is("input:checkbox,input:radio,select,input:file")&&(p="change"),$(this).unbind(p+".bVerror"),$(this).bind(p+".bVerror",{bValidatorInstance:instance},function(e){e.data.bValidatorInstance.validate(!1,$(this))})}if(options.singleError)return!1}else _removeErrMsg($(this)),$(this).is("input:checkbox,input:radio")||($(this).removeClass(options.errorClass),options.validClass&&$(this).addClass(options.validClass)),options.validateOn&&($(this).unbind(options.validateOn+".bV"),_bindValidateOn($(this)))}),i},this.getOptions=function(){return options},this.isValid=function(){return this.validate(!0)},this.removeErrMsg=function(e){_removeErrMsg(e)},this.getInputs=function(){return _getElementsForValidation(mainElement)},this.bindValidateOn=function(e){_bindValidateOn(e)},this.reset=function(){elements=_getElementsForValidation(mainElement),options.validateOn&&_bindValidateOn(elements),elements.each(function(){_removeErrMsg($(this)),$(this).unbind(".bVerror"),$(this).removeClass(options.errorClass),$(this).removeClass(options.validClass)})},this.destroy=function(){mainElement.is("form")&&mainElement.unbind(".bV"),this.reset(),mainElement.removeData("bValidator")}}}(jQuery);